<!DOCTYPE html>
<html lang="en-US">
<head>
<title>3D Animation Descriptions Test</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://rawgit.com/lidaiqing/animation-mturk/master/js/BrowserDetect.js"></script>
<script src="https://rawgit.com/lidaiqing/animation-mturk/master/js/Navigation.js"></script>
<script src="https://rawgit.com/lidaiqing/animation-mturk/master/js/Demographics.js"></script>
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script>

<style type="text/css">
.wrapper {
	height: 80%;
	width: 100%;
	display: table;
}

.page {
	display: table-cell;
	vertical-align: middle;
}

.cell {
	margin: 0 auto;
	padding: 10px;
	width: 850px;
}

#pagenum {
	text-align: center;
	font-style: italic;
}
.disclaimer {
	font-weight: bold;
	color: #555555;
}

.warning {
	font-weight: bold;
}

body {
	-webkit-touch-callout: none;
	-webkit-user-select: none;
	-khtml-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}
</style>
<script>
function getImageId(groupId) {
	var id1 = (parseInt(groupId)-1) * 3;
	var id2 = id1 + 1;
	var id3 = id2 + 1;
	var animation_number = 48;
	var page_number = 52;
	var id_list = [];
	id_list[0] = (Math.round(id1/animation_number)+1).toString() + '-' + ((id1 % animation_number) + 1).toString();
	id_list[1] = (Math.round(id2/animation_number)+1).toString() + '-' + ((id2 % animation_number) + 1).toString();
	id_list[2] = (Math.round(id3/animation_number)+1).toString() + '-' + ((id3 % animation_number) + 1).toString();
	console.log('groupId:' + groupId + ' id1:' + id_list[0] + 'id2:' + id_list[1] + 'id3:' + id_list[2]);
	return id_list;
}

function gup(name)
{
	var regexS = "[\\?&]"+name+"=([^&#]*)";
    var regex = new RegExp( regexS );
    var tmpURL = window.location.href;
    var results = regex.exec( tmpURL );
    if( results == null )
        return "";
    else
        return results[1];
}

function submitResults() {
	var groupId = gup('groupId');
	if (groupId == "") groupId = "1";
	var id_list = getImageId(groupId);
	document.getElementById('form_description1').value = document.getElementById('description1').value;
	document.getElementById('form_description1').name = id_list[0] + "description";
	document.getElementById('form_practical1').value = document.getElementById('practical1').value;
	document.getElementById('form_practical1').name = id_list[0] + "practical1";

	document.getElementById('form_description2').value = document.getElementById('description2').value;
	document.getElementById('form_description2').name = id_list[1] + "description";
	document.getElementById('form_practical2').value = document.getElementById('practical2').value;
	document.getElementById('form_practical2').name = id_list[1] + "practical2";

	document.getElementById('form_description3').value = document.getElementById('description3').value;
	document.getElementById('form_description3').name = id_list[2] + "description";
	document.getElementById('form_practical3').value = document.getElementById('practical3').value;
	document.getElementById('form_practical3').name = id_list[2] + "practical3";

	document.getElementById('form_comments').value = document.getElementById('comments').value;
	document.forms["mturk_form"].submit();
}

$(document).ready(function()
{
	document.getElementById('assignmentId').value = gup('assignmentId');
  console.log(gup('assignmentId'));
  if (gup('assignmentId') == "ASSIGNMENT_ID_NOT_AVAILABLE") {
      // If we're previewing, disable the button and give it a helpful message
      document.getElementById('submitButton').disabled = true;
      document.getElementById('submitButton').value = "You must ACCEPT the HIT before you can submit the results.";
  } else {
      var form = document.getElementById('mturk_form');
      form.action = "https://www.mturk.com/mturk/externalSubmit";
            //if (document.referrer && ( document.referrer.indexOf('workersandbox') != -1) ) {
    	//form.action = "https://workersandbox.mturk.com/mturk/externalSubmit";
             //   form.action = "https://www.mturk.com/mturk/externalSubmit";
           // }
  }
  set_gif_tag();
	set_gif_src();

	function set_gif_tag() {
		var json_url = "https://lidaiqing.github.io/animation-mturk/json/items_info.json"
		$.getJSON(json_url, function(tags) {
			var groupId = gup('groupId');
			if (groupId == "") groupId = "1";
			var id_list = getImageId(groupId);
			var id1 = id_list[0];
			var id2 = id_list[1];
			var id3 = id_list[2];
			if (id1 == "") id1 = '1-1';
			if (id2 == "") id2 = '1-2';
			if (id3 == "") id3 = '1-3';
			for (var i in tags) {
				if (tags[i].id == id1) {
					$('#tag1').text("Action tag: " + tags[i].action);
					console.log(tags[i]);
				}
				if (tags[i].id == id2) {
					$('#tag2').text("Action tag: " + tags[i].action);
					console.log(tags[i]);
				}
				if (tags[i].id == id3) {
					$('#tag3').text("Action tag: " + tags[i].action);
					console.log(tags[i]);
				}
			}
		});
	}
	function set_gif_src() {
		var groupId = gup('groupId');
		if (groupId == "") groupId = "1";
		var id_list = getImageId(groupId);
		var id1 = id_list[0];
		var id2 = id_list[1];
		var id3 = id_list[2];
		if (id1 == "") id1 = '1-1';
		if (id2 == "") id2 = '1-2';
		if (id3 == "") id3 = '1-3';
		var baseURL = "https://s3.amazonaws.com/animation-mturk/image/";
		$("#gif1").attr("src",baseURL + id1 + ".gif");
		$("#gif2").attr("src",baseURL + id2 + ".gif");
		$("#gif3").attr("src",baseURL + id3 + ".gif");
	}
});
</script>

<div class="wrapper">

<div class="page" id="1">
<div class="cell">

<div align="center"><h1>3D Animation Description Test</h1></div>

<div class="warning">Please only complete this HIT once. You will not be paid for retakes. If you have already completed this HIT or any other version of this HIT and submit it again, all submissions but the first will be rejected, and you will only be paid for the first submission. Having a submission rejected is detrimental to your reputation as a worker, and may prevent you from completing HITs in the future.</div>
<br />

<p>In this study, you will be shown a list of 3D animations. For each animation, please watch it fully and give it a short description in English words. Please make it a full English sentence without grammar mistakes.</p>

<p><b>Technical requirements:</b></p>
<ul>
       <li>This experiment will only work in Firefox version 20 or higher, Chrome version 25 or higher, Safari version 5 or higher, or Internet Explorer version 10 or higher.</li>
       <li>Please allow permission for Javascript to run on this site and disable any script blockers that are running.</li>
</ul>

<input type="button" value="Continue" onclick="next();" />
</div>
</div>

<div class="page" id="2" style="display: none;">
<div class="cell">

<div align="center"><h1>Instructions</h1></div>

<p style="color:red;">1. Write a natural sentence describing the action in the video. Someone reading just the sentence should have a vivid impression of what the actor is doing.</p>
<p style="color:red;">2. Please write a description for 3 videos. Videos are unrelated, so treat each one individually. </p>
<p style="color:red;">3. Please also choose if this action can happen in real life (a normal people can do it). </p>
<p style="color:red;">4. We will be checking the descriptions. Your HIT will be rejected if the sentences are not descriptive or not grammatically correct. </p>

<p>Here is an example of the description.</p>
<p>Action tag: Grenade Throw </p>
<img src="https://s3.amazonaws.com/animation-mturk/image/1-40.gif"></img>
<br /><br />
<p>Description(5-20 words):</p>
<textarea rows="4" cols="50" disabled>
A man is throwing a grenade while kneeling pulling pin with teeth.
</textarea>
<p> Can this action happen in real life?
<select>
	<option value="yes">Yes</option>
	<option value="no">No</option>
</select>
</p>
<input type="button" value="Go back" onclick="back();" />
<input type="button" value="Continue" onclick="next();" />

</div>
</div>

<div class="page" id="3" style="display: none;">
<div class="cell">

<p>Please make a description about this animation in full English sentence.</p>
<p id="tag1"> </p>
<img id="gif1" src=""></img>
<br /><br />
Description(5-20 words):
<br /><br />
<textarea name="descriptions" id="description1" rows="4" cols="50"></textarea>
<br /><br />
<p> Can this action happen in real life?
<select id="practical1">
	<option value="yes">Yes</option>
	<option value="no">No</option>
</select>
</p>
<input type="button" value="Go back" onclick="back();" />
<input type="button" value="Continue" onclick="function textCheck(id) { return document.getElementById(id).value.split(' ').length > 5} if(textCheck('description1')) { next(); }else{ alert('Please type in at lease 5 words!'); }" />

</div>
</div>

<div class="page" id="4" style="display: none;">
<div class="cell">

<p>Please make a description about this animation in full English sentence.</p>
<p id="tag2"> </p>
<img id="gif2" src=""></img>
<br /><br />
Description(5-20 words):
<br /><br />
<textarea name="descriptions" id="description2" rows="4" cols="50"></textarea>
<br /><br />
<p> Is this action natural and realistic?
<select id="practical2">
	<option value="yes">Yes</option>
	<option value="no">No</option>
</select>
</p>
<input type="button" value="Go back" onclick="back();" />
<input type="button" value="Continue" onclick="function textCheck(id) { return document.getElementById(id).value.split(' ').length > 5} if(textCheck('description2')) { next(); }else{ alert('Please type in at lease 5 words!'); }" />

</div>
</div>

<div class="page" id="5" style="display: none;">
<div class="cell">

<p>Please make a description about this animation in full English sentence.</p>
<p id="tag3"> </p>
<img id="gif3" src=""></img>
<br /><br />
Description(5-20 words):
<br /><br />
<textarea name="descriptions" id="description3" rows="4" cols="50"></textarea>
<br /><br />
<p> Can this action happen in real life?
<select id="practical3">
	<option value="yes">Yes</option>
	<option value="no">No</option>
</select>
</p>
<input type="button" value="Go back" onclick="back();" />
<input type="button" value="Continue" onclick="function textCheck(id) { return document.getElementById(id).value.split(' ').length > 5} if(textCheck('description2')) { next(); }else{ alert('Please type in at lease 5 words!'); }" />

</div>
</div>

<div class="page" id="6" style="display: none;">
<div class="cell">

<p>Thank you very much for participating in this study.</p>
<p>Please enter any comments you have about this HIT in the box below:</p>
<textarea name="comments" id="comments" rows="4" cols="50"></textarea>
<br /><br />

<input type="button" value="Go back" onclick="back();" />
<input type="button" value="Continue" onclick="next();" />

</div>
</div>

<div class="page" id="7" style="display: none;">
<div class="cell">

<p>Thank you for your help!</p>
<br />
<input type="button" value="Go back" onclick="back();" />
<form id="mturk_form" method="POST" action="">
	<input type="hidden" id="assignmentId" name="assignmentId" value="">
	<input type="hidden" id="form_description1" name="" value="">
	<input type="hidden" id="form_practical1" name="" value="">
	<input type="hidden" id="form_description2" name="" value="">
	<input type="hidden" id="form_practical2" name="" value="">
	<input type="hidden" id="form_description3" name="" value="">
	<input type="hidden" id="form_practical3" name="" value="">
	<input type="hidden" id="form_comments" name="comments" value="">
  <input id="submitButton" type="button" value="Submit" onclick="submitResults();">
</form>
</div>
</div>

</div>

<center><script>makePageNumber("Page 1 / 7");</script></center>
